import sys
sys.path.insert(0, r'E:\GitHub\CeVIOPy')
from ceviopy.cevio import Cevio
import time

def ci_presentation_v3():
    """CI構想プレゼンテーション v3版 - さとうささら音声合成版
    
    v3改訂のポイント：
    - スライド数を35枚→25枚に削減
    - 船の表現を軽く調整
    - AI vs. CIの説明を明確化
    - 具体例（競馬会）を追加
    - ささらの天然キャラを強化
    """
    t = Cevio(mode="AI")
    
    print("=== CI構想プレゼンテーション v3版 開始 ===")
    print("操作方法: 各スライドでEnterキーを押すと次に進みます")
    print("終了したい場合は Ctrl+C を押してください")
    print()
    
    # === 導入 ===
    print("=== スライド1: タイトル ===")
    t.speak("皆さん、こんにちは！わたし、さとうささらです！")
    time.sleep(1)
    t.speak("今日は、修道25回生の皆さんがこれから取り組もうという「CI構想」について、")
    t.speak("わかりやすくお話しさせていただきます！")
    input("次のスライドに進むにはEnterを押してください...")
    
    print("=== スライド2: 自己紹介・導入 ===")
    t.speak("CIって何の略だと思いますか？")
    time.sleep(1)
    t.speak("AIじゃないんです...いや、AIも使うんですけど！")
    time.sleep(0.5)
    t.speak("CI、つまり「コレクティブ インテリジェンス」、")
    t.speak("日本語で言うと「集団知性」のことなんです！")
    time.sleep(1)
    t.speak("つまり、「人間プラスAI、イコール、もっとすごい！」ってことなんです。")
    time.sleep(1)
    t.speak("実は今日のお話、ちょっと重要なテーマも含んでいるんですが、")
    t.speak("でも大丈夫！一緒に楽しく学んでいきましょう！")
    input("次のスライドに進むにはEnterを押してください...")
    
    # === 第1部：人類の大きな学習体験 ===
    print("=== スライド3: 第1部タイトル ===")
    t.speak("それでは第1部、「人類の大きな学習体験」から始めましょう！")
    t.speak("船の話から学ぶことがテーマです。")
    input("次のスライドに進むにはEnterを押してください...")
    
    print("=== スライド4: 地球という船 ===")
    t.speak("まず、今の地球の状況を、ちょっと面白い視点で見てみますね。")
    time.sleep(1)
    t.speak("想像してみてください。")
    t.speak("地球を「今、ちょっとピンチな船」だと考えてみます。")
    t.speak("この船に乗っているのは、私たち人類全員です。")
    time.sleep(1)
    t.speak("実は、この船、気候変動という大きな波がきちゃって、")
    t.speak("みんなで協力すれば何とかなるはずなのに、")
    t.speak("うまく連携できなかったんです。")
    input("次のスライドに進むにはEnterを押してください...")
    
    print("=== スライド5: 人類の反応パターン ===")
    t.speak("普通なら、船が危険だとわかったら、")
    t.speak("乗船者みんなで協力して対処するはずですよね？")
    t.speak("でも実際はどうだったでしょうか？")
    time.sleep(1)
    t.speak("船の一部の人：「やばい、大変！」")
    time.sleep(1)
    t.speak("別の場所の人：「え？本当？実感ないなあ」")
    time.sleep(1)
    t.speak("また別の人：「大丈夫でしょ、今まで通りで」")
    time.sleep(1.5)
    t.speak("あれれ？なんか変だな...って思いませんか？")
    time.sleep(0.5)
    t.speak("人類って、意外と連携するのが苦手だったんですね！")
    input("次のスライドに進むにはEnterを押してください...")
    
    print("=== スライド6: でも、これってすごく勉強になる！ ===")
    t.speak("でも、これってすごく勉強になるんです！")
    t.speak("人類の集団行動の特徴がわかった！")
    t.speak("とても貴重な学習体験です。")
    t.speak("次はもっと上手くできるはず。")
    t.speak("ここからが面白いんですよ！")
    input("次のスライドに進むにはEnterを押してください...")
    
    # === 第2部：なぜうまくいかなかったの？ ===
    print("=== スライド7: 第2部タイトル ===")
    t.speak("第2部では、「なぜうまくいかなかったの？」について考えてみましょう。")
    t.speak("従来の情報共有を振り返ってみますね。")
    input("次のスライドに進むにはEnterを押してください...")
    
    print("=== スライド8: 今までの情報共有の問題点 ===")
    t.speak("じゃあ、なぜ人類はこの大きなチャレンジで")
    t.speak("うまく連携できなかったんでしょう？")
    time.sleep(1)
    t.speak("今までの情報共有の方法を振り返ってみましょう。")
    time.sleep(1)
    t.speak("テレビで専門家が「危険です！」と説明。")
    t.speak("新聞で「対策が必要」と記事に。")
    t.speak("でも、みんなの心には響かなかった...")
    time.sleep(1)
    t.speak("問題点を整理してみると...")
    t.speak("情報が一方通行で伝わりにくかった。")
    t.speak("人それぞれの理解度にバラつきが出た。")
    t.speak("共通理解を作るのが難しかった。")
    time.sleep(1)
    t.speak("でも、失敗から学べます！")
    input("次のスライドに進むにはEnterを押してください...")
    
    print("=== スライド9: CI構想の登場 ===")
    t.speak("そこで登場！")
    time.sleep(1)
    t.speak("CI構想です！")
    time.sleep(1)
    t.speak("人類の新しいチャレンジ！")
    input("次のスライドに進むにはEnterを押してください...")
    
    # === 第3部：CI構想の「魔法の循環」 ===
    print("=== スライド10: 第3部タイトル ===")
    t.speak("第3部では、CI構想の「魔法の循環」について詳しく説明します！")
    t.speak("これまでの失敗を踏まえて、今度はどうするか！")
    input("次のスライドに進むにはEnterを押してください...")
    
    print("=== スライド11: CI構想の4つのステップ ===")
    t.speak("CI構想には「魔法の循環」があるんです！")
    time.sleep(1)
    t.speak("4つのステップがあります。")
    t.speak("1つ目、個人の発信。")
    t.speak("2つ目、AIの学習。")
    t.speak("3つ目、AIによる応答。")
    t.speak("4つ目、理解の深化。")
    t.speak("そして、また1に戻ります。")
    time.sleep(1)
    t.speak("この循環で、みんなで一緒に賢くなれる！")
    input("次のスライドに進むにはEnterを押してください...")
    
    # 循環の各ステップ
    circulation_steps = [
        {
            "num": 12,
            "title": "1. 個人の発信",
            "explanation": [
                "まず1つ目は、個人の発信です。",
                "一人一人が自分の考えをちゃんと発信します。",
                "「わたしはこう思う」",
                "「こんな体験をした」",
                "みんなが参加型で情報を出し合うんです！"
            ]
        },
        {
            "num": 13,
            "title": "2. AIの学習",
            "explanation": [
                "2つ目は、AIの学習です。",
                "AIが上手に整理・学習してくれます。",
                "AIって本当に賢いですよね！",
                "わたしより整理上手かも。",
                "たくさんの人の考えがきちんと蓄積されていきます。"
            ]
        },
        {
            "num": 14,
            "title": "3. AIによる応答 → 4. 理解の深化",
            "explanation": [
                "3つ目は、AIによる応答です。",
                "質問すると、みんなの考えを踏まえてAIが応答します。",
                "一人の専門家じゃなく、みんなの知恵が反映！",
                "そして、4つ目、理解の深化。",
                "「あ、そういうことか！」って新しい理解が生まれる。",
                "そしてまた発信する...",
                "循環が続くんです！"
            ]
        }
    ]
    
    for step in circulation_steps:
        print(f"=== スライド{step['num']}: {step['title']} ===")
        for explanation in step["explanation"]:
            t.speak(explanation)
            time.sleep(0.8)
        input("次のスライドに進むにはEnterを押してください...")
    
    print("=== スライド15: ワクワクする結果 ===")
    t.speak("この循環で、今度こそ、みんなで一緒に賢くなれる！")
    time.sleep(1)
    t.speak("すごくワクワクしませんか？")
    t.speak("これが「集団知性」の力なんです！")
    input("次のスライドに進むにはEnterを押してください...")
    
    # === 第4部：修道25回生の実験！ ===
    print("=== スライド16: 第4部タイトル ===")
    t.speak("第4部では、修道25回生の実験について話します！")
    t.speak("パイオニアとしての挑戦ですよ！")
    input("次のスライドに進むにはEnterを押してください...")
    
    print("=== スライド17: 私たちの具体的な活動 ===")
    t.speak("実は修道25回生では、この「人類の新しいチャレンジ」の")
    t.speak("パイオニアになろうとしているんです！")
    time.sleep(1)
    t.speak("具体的には、")
    t.speak("同期会の活動をAIが学習しやすい形で整理。")
    t.speak("ウェブサイトに体系的に記録。")
    t.speak("みんなの経験や知識を共有できる仕組み作り。")
    time.sleep(1)
    t.speak("具体例を挙げると、")
    t.speak("「気楽に集まる会」、例えば、競馬を楽しむ会の報告がウェブサイトに載っています。")
    t.speak("定例同期会での真剣な議論の記録。")
    t.speak("それぞれの人生経験、知恵の共有。")
    input("次のスライドに進むにはEnterを押してください...")
    
    print("=== スライド18: 「修道25回生の集団知性」が育つ！ ===")
    t.speak("一人一人の経験が集まって、")
    t.speak("みんなで学び合って、")
    t.speak("人類の新しい実験。")
    time.sleep(1)
    t.speak("これって、とても大切なチャレンジだと思いませんか？")
    input("次のスライドに進むにはEnterを押してください...")
    
    # === 第5部：修道精神とCI構想 ===
    print("=== スライド19: 第5部タイトル ===")
    t.speak("第5部では、修道精神とCI構想について話しますね。")
    t.speak("「世の進運に先駆けん」の新しい形です。")
    input("次のスライドに進むにはEnterを押してください...")
    
    print("=== スライド20: 校歌、覚えていますよね？ ===")
    t.speak("修道高校の校歌、覚えていますよね？")
    t.speak("「世の進運に先駆けん」です！")
    time.sleep(1)
    t.speak("気候変動では後手に回ってしまった。")
    t.speak("でも、だからこそ今度は先手を打つ！")
    t.speak("次の大きな課題では協力できるように。")
    time.sleep(1)
    t.speak("CI構想は、修道精神の新時代版なんです。")
    t.speak("新しい技術（AI）を上手に使って、")
    t.speak("人間同士のつながりを深めて、")
    t.speak("人類がもっと賢く、協力上手になる！")
    input("次のスライドに進むにはEnterを押してください...")
    
    # === 第6部：3つのお願い ===
    print("=== スライド21: 第6部タイトル ===")
    t.speak("第6部では、皆さんにお願いがあります！")
    t.speak("あなたも一緒にチャレンジしませんか？")
    t.speak("3つのお願いです。")
    input("次のスライドに進むにはEnterを押してください...")
    
    print("=== スライド22: 3つのお願い ===")
    t.speak("最後に、皆さんにお願いがあります！")
    t.speak("この面白い実験に、ぜひ参加してください。")
    time.sleep(1)
    t.speak("1つ目、自分の考えを発信してください。")
    t.speak("小さなことでも大丈夫！")
    t.speak("あなたの体験や気づきをシェアしてください。")
    time.sleep(1)
    t.speak("2つ目は、AIを友達だと思って活用してください。")
    t.speak("AIは怖いものじゃありません。")
    t.speak("理解を助けてくれる頼もしいパートナーです。")
    time.sleep(1)
    t.speak("3つ目は、人間らしさを大切にしてください。")
    t.speak("友情、思いやり、創造性。")
    t.speak("これらは私たちだけの特別な宝物です！")
    input("次のスライドに進むにはEnterを押してください...")
    
    # === 結び ===
    print("=== スライド23: 結び - CI構想のまとめ ===")
    t.speak("CI構想を通じて、私たちは、")
    t.speak("個人として、もっと成長。")
    t.speak("グループとして、もっと賢く。")
    t.speak("社会全体に、素敵な貢献。")
    time.sleep(1)
    t.speak("気候変動では後手に回った人類。")
    t.speak("でも今度こそ、次のチャレンジでは")
    t.speak("みんなで力を合わせて素晴らしい結果を！")
    input("次のスライドに進むにはEnterを押してください...")
    
    print("=== スライド24: 修道25回生のパイオニアとして ===")
    t.speak("修道25回生の皆さんが、")
    t.speak("新時代のパイオニアとして、")
    t.speak("人類の新しいチャレンジに挑戦。")
    time.sleep(1)
    t.speak("一緒に頑張りましょう！")
    time.sleep(1)
    t.speak("活躍を心から楽しみにしています！")
    input("次のスライドに進むにはEnterを押してください...")
    
    # === 終了 ===
    print("=== スライド25: ありがとうございました！ ===")
    t.speak("ご清聴ありがとうございました！")
    t.speak("何かご質問があれば、お気軽にどうぞ！")
    time.sleep(1)
    t.speak("わたし、さとうささらでした！")
    
    print()
    print("=== プレゼンテーション終了 ===")
    print("お疲れさまでした！")

if __name__ == "__main__":
    print("CI構想プレゼンテーション v3版 - さとうささら音声合成版")
    print("========================================")
    print("主な改善点:")
    print("- スライド数: 35枚 → 25枚に削減")
    print("- 船の表現: 「沈没」 → 「ピンチ」に軽減")
    print("- AI vs. CI: 明確化（AIも使うけど、人間+AI）")
    print("- 具体例: 競馬を楽しむ会を追加")
    print("- ささらキャラ: 天然要素を強化")
    print()
    
    try:
        ci_presentation_v3()
    except KeyboardInterrupt:
        print("\nプレゼンテーションを中断しました。")
    except Exception as e:
        print(f"エラーが発生しました: {e}")
        print("CeVIOやCeVIOPyライブラリの設定を確認してください。")
